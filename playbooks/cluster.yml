---
- name: Deploy RKE2 cluster
  hosts:
    - rke2_scheduler
    - rke2_worker
  become: yes
  roles:
    - avahi
    - python
    - lablabs.rke2

- name: Update path for schedulers
  hosts:
    - rke2_scheduler
  tasks:
    - name: Insert /var/lib/rancher/rke2/bin into PATH in .profile
      ansible.builtin.lineinfile:
        path: "~/.profile"
        line: 'export PATH="${PATH}:/var/lib/rancher/rke2/bin"'
        insertafter: EOF

- name: Deploy cluster tools
  hosts:
    - rke2_scheduler
  become: yes
  roles:
    - andrewrothstein.k9s
