---
- name: add source repository into sources list
  apt_repository:
    repo: deb http://archive.canonical.com/ubuntu jammy multiverse
    state: present

- name: add 32bit architecture installation for Debian
  import_tasks: debian-32bit.yml

- name: ensure build dependencies
  apt:
    pkg:
      - bc
      - binutils
      - bsdmainutils
      - bzip2
      - ca-certificates
      - curl
      - file
      - gzip
      - jq
      - lib32gcc-s1
      - lib32stdc++6
      - libicu-dev
      - libsdl2-2.0-0:i386
      - netcat
      - python3
      - steamcmd
      - tar
      - tmux
      - util-linux
      - unzip
      - wget
  environment:
    DEBIAN_FRONTEND: noninteractive

- name: create btserver user
  user:
    name:  btserver
    shell: /bin/bash

- name: retrieve LinuxGSM script
  get_url:
    url: https://linuxgsm.sh
    dest: /home/btserver/linuxgsm.sh
    mode: '750'

- name: install Barotrauma module
  shell:
    cmd: ./linuxgsm.sh btserver
  become: true
  become_user: btserver

- name: install Barotrauma
  shell:
    cmd: ./btserver install
  become: true
  become_user: btserver

